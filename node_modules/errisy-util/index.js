"use strict";var md5Module=require("errisy-util/md5"),ng2cookie=require("errisy-util/cookie"),RSAKeypair=require("errisy-util/keypair");require("errisy-string");var util;(function(a){a.setField=function(x,y){for(var z in y)x[z]=y[z];return x},a.geometryBox=function(x,y,z,A){return[[[x,z],[y,z],[y,A],[x,A],[x,z]]]},a.emailPattern=/(?=[a-z0-9@.!#$%&'*+/=?^_`{|}~-]{6,254})(?=[a-z0-9.!#$%&'*+/=?^_`{|}~-]{1,64}@)[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:(?=[a-z0-9-]{1,63}\.)[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+(?=[a-z0-9-]{1,63})[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/ig,a.isValidEmail=function(x){return a.emailPattern.lastIndex=-1,a.emailPattern.test(x)},a.isInvalidOrEmptyString=function(x){return"string"!=typeof x||0==x.length},a.isValidNotNullString=function(x){return"string"==typeof x&&0<x.length},a.checkPasswordStrength=function(x){var y={strength:0,suggestion:"empty"},z=0;if(!x)return y;for(var A={},B=0;B<x.length;B++)A[x[B]]=(A[x[B]]||0)+1,z+=5/A[x[B]];var C={digits:/\d/.test(x),lower:/[a-z]/.test(x),upper:/[A-Z]/.test(x),nonWords:/\W/.test(x)},D=0;for(var E in C)D+=!0==C[E]?1:0;return z+=10*(D-1),y.strength=z,60>z&&(y.suggestion="weak"),60<=z&&(y.suggestion="medium"),80<=z&&(y.suggestion="strong"),y},a.GetGeoLocation=function(){return new Promise(function(x,y){navigator.geolocation.getCurrentPosition(function(z){x(z)},function(z){y(z)})})};var v=function(){function x(){}return x.prototype.parseGoogleAddressObject=function(y){var z=this;if("OK"==y.status&&0<y.results.length){var A=y.results[0];this.FullAddress=A.formatted_address,A.address_components.forEach(function(B){switch(B.types[0]){case"street_number":z.Number=B.long_name;break;case"route":z.Street=B.long_name;break;case"locality":z.SuburbTown=B.long_name;break;case"administrative_area_level_2":z.CityRegion=B.long_name;break;case"administrative_area_level_1":z.StateProvince=B.long_name;break;case"country":z.CountryTerritory=B.long_name;break;case"postal_code":z.Postcode=B.long_name;}})}},x}();a.Address=v,a.ResolveAddress=function(x,y){return new Promise(function(z){var B=new XMLHttpRequest;B.onreadystatechange=function(){switch(B.readyState){case XMLHttpRequest.DONE:var C=JSON.parse(B.responseText),D=new v;D.parseGoogleAddressObject(C),z(D);}},B.open("POST","https://maps.googleapis.com/maps/api/geocode/json?latlng="+x+","+y+"&sensor=false&language=en-au"),B.send(null)})},a.md5=md5Module.md5,a.randomstring=function(x,y){(x==void 0||null==x)&&(x=32),y||(y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789");for(var z=y.length,A="",B=0;B<x;B++)A+=y.charAt(Math.floor(z*Math.random()));return A},a.cookie=ng2cookie.Cookie,a.wait=function(x){return new Promise(function(y){return setTimeout(function(){return y()},x)})},a.keypair=RSAKeypair,a.getURLParameters=function(){var x={};if(/\?(&?(\w+)=(\w+))+$/ig.test(window.location.search))for(var z,y=/\?(&?(\w+)=(\w+))+$/ig.exec(window.location.search)[0],A=/(&?(\w+)=(\w+))/ig;z=A.exec(y);)x[z[2]]=z[3];return x},a.setURL=function(x){window&&window.history&&window.history.pushState?window.history.pushState("object or string",document.title,x):window&&window.pushState&&window.pushState("object or string",document.title,x)},a.escapeHTML=function(x){return x.replace(/[><& ]/ig,function(y){return">"===y?"&gt;":"<"===y?"&lt;":"&"===y?"&amp;":" "===y?"&nbsp;":void 0})},a.unescapeHTML=function(x){return x.replace(/&(gt|lt|amp|nbsp);/ig,function(y){return"&gt;"===y?">":"&lt;"===y?"<":"&amp;"===y?"&":"&nbsp;"===y?" ":void 0})},a.date=function(x){("number"!=typeof x||Number.isNaN(x))&&(x=0);var y=new Date(Date.now()+8.64e7*x);return y.getFullYear()+"-"+(y.getMonth()+1+"").padLeft(2,"0")+"-"+(y.getDate()+"").padLeft(2,"0")},a.toYYYYMMDD=function(x){var y=new Date(x);return y.getFullYear()+"-"+(y.getMonth()+1+"").padLeft(2,"0")+"-"+(y.getDate()+"").padLeft(2,"0")},a.datetime=function(x){("number"!=typeof x||Number.isNaN(x))&&(x=0);var y=new Date(Date.now()+1e3*x);return y.getFullYear()+"-"+(y.getMonth()+1+"").padLeft(2,"0")+"-"+(y.getDate()+"").padLeft(2,"0")+" "+(y.getHours()+"").padLeft(2,"0")+":"+(y.getMinutes()+"").padLeft(2,"0")+":"+(y.getSeconds()+"").padLeft(2,"0")};var w=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];a.weekday=function(x){return("number"!=typeof x||Number.isNaN(x))&&(x=0),w[new Date(Date.now()+8.64e7*x).getDay()]},a.dayOfWeek=function(x){return w[x]}})(util||(util={})),module&&(module.exports=util),module.exports=util;