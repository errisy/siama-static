"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},forge={},aes=forge.aes={},md=forge.md={},pki=forge.pki={},rsa=forge.pki.rsa=forge.rsa={},util=forge.util={};module.exports=function(o){o||(o={}),"undefined"==typeof o.bits&&(o.bits=2048);var B=forge.rsa.generateKeyPair(o);return B={public:fix(forge.pki.publicKeyToRSAPublicKeyPem(B.publicKey,72)),private:fix(forge.pki.privateKeyToPem(B.privateKey,72))},B};function fix(o){return o.replace(/\r/g,"")+"\n"}util.fillString=function(o,B){for(var T="";0<B;)1&B&&(T+=o),B>>>=1,0<B&&(o+=o);return T};var sha1=forge.sha1=forge.md.sha1={},_padding=null,_initialized=!1,_init=function(){_padding=String.fromCharCode(128),_padding+=forge.util.fillString(String.fromCharCode(0),64),_initialized=!0},_update=function(B,T,E){for(var I,C,S,A,D,N,R,L,P=E.length();64<=P;){for(C=B.h0,S=B.h1,A=B.h2,D=B.h3,N=B.h4,L=0;16>L;++L)I=E.getInt32(),T[L]=I,R=D^S&(A^D),I=(C<<5|C>>>27)+R+N+1518500249+I,N=D,D=A,A=S<<30|S>>>2,S=C,C=I;for(;20>L;++L)I=T[L-3]^T[L-8]^T[L-14]^T[L-16],I=I<<1|I>>>31,T[L]=I,R=D^S&(A^D),I=(C<<5|C>>>27)+R+N+1518500249+I,N=D,D=A,A=S<<30|S>>>2,S=C,C=I;for(;32>L;++L)I=T[L-3]^T[L-8]^T[L-14]^T[L-16],I=I<<1|I>>>31,T[L]=I,R=S^A^D,I=(C<<5|C>>>27)+R+N+1859775393+I,N=D,D=A,A=S<<30|S>>>2,S=C,C=I;for(;40>L;++L)I=T[L-6]^T[L-16]^T[L-28]^T[L-32],I=I<<2|I>>>30,T[L]=I,R=S^A^D,I=(C<<5|C>>>27)+R+N+1859775393+I,N=D,D=A,A=S<<30|S>>>2,S=C,C=I;for(;60>L;++L)I=T[L-6]^T[L-16]^T[L-28]^T[L-32],I=I<<2|I>>>30,T[L]=I,R=S&A|D&(S^A),I=(C<<5|C>>>27)+R+N+2400959708+I,N=D,D=A,A=S<<30|S>>>2,S=C,C=I;for(;80>L;++L)I=T[L-6]^T[L-16]^T[L-28]^T[L-32],I=I<<2|I>>>30,T[L]=I,R=S^A^D,I=(C<<5|C>>>27)+R+N+3395469782+I,N=D,D=A,A=S<<30|S>>>2,S=C,C=I;B.h0+=C,B.h1+=S,B.h2+=A,B.h3+=D,B.h4+=N,P-=64}};sha1.create=function(){_initialized||_init();var o=null,B=forge.util.createBuffer(),T=Array(80),E={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0};return E.start=function(){E.messageLength=0,B=forge.util.createBuffer(),o={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520}},E.start(),E.update=function(I,C){"utf8"===C&&(I=forge.util.encodeUtf8(I)),E.messageLength+=I.length,B.putBytes(I),_update(o,T,B),(2048<B.read||0===B.length())&&B.compact()},E.digest=function(){var I=E.messageLength,C=forge.util.createBuffer();C.putBytes(B.bytes()),C.putBytes(_padding.substr(0,64-(I+8)%64)),C.putInt32(255&I>>>29),C.putInt32(4294967295&I<<3);var S={h0:o.h0,h1:o.h1,h2:o.h2,h3:o.h3,h4:o.h4};_update(S,T,C);var A=forge.util.createBuffer();return A.putInt32(S.h0),A.putInt32(S.h1),A.putInt32(S.h2),A.putInt32(S.h3),A.putInt32(S.h4),A},E},util.ByteBuffer=function(o){this.data=o||"",this.read=0},util.ByteBuffer.prototype.length=function(){return this.data.length-this.read},util.ByteBuffer.prototype.isEmpty=function(){return 0==this.data.length-this.read},util.ByteBuffer.prototype.putByte=function(o){this.data+=String.fromCharCode(o)},util.ByteBuffer.prototype.fillWithByte=function(o,B){o=String.fromCharCode(o);for(var T=this.data;0<B;)1&B&&(T+=o),B>>>=1,0<B&&(o+=o);this.data=T},util.ByteBuffer.prototype.putBytes=function(o){this.data+=o},util.ByteBuffer.prototype.putString=function(o){this.data+=util.encodeUtf8(o)},util.ByteBuffer.prototype.putInt16=function(o){this.data+=String.fromCharCode(255&o>>8)+String.fromCharCode(255&o)},util.ByteBuffer.prototype.putInt24=function(o){this.data+=String.fromCharCode(255&o>>16)+String.fromCharCode(255&o>>8)+String.fromCharCode(255&o)},util.ByteBuffer.prototype.putInt32=function(o){this.data+=String.fromCharCode(255&o>>24)+String.fromCharCode(255&o>>16)+String.fromCharCode(255&o>>8)+String.fromCharCode(255&o)},util.ByteBuffer.prototype.putInt16Le=function(o){this.data+=String.fromCharCode(255&o)+String.fromCharCode(255&o>>8)},util.ByteBuffer.prototype.putInt24Le=function(o){this.data+=String.fromCharCode(255&o)+String.fromCharCode(255&o>>8)+String.fromCharCode(255&o>>16)},util.ByteBuffer.prototype.putInt32Le=function(o){this.data+=String.fromCharCode(255&o)+String.fromCharCode(255&o>>8)+String.fromCharCode(255&o>>16)+String.fromCharCode(255&o>>24)},util.ByteBuffer.prototype.putInt=function(o,B){do B-=8,this.data+=String.fromCharCode(255&o>>B);while(0<B)},util.ByteBuffer.prototype.putBuffer=function(o){this.data+=o.getBytes()},util.ByteBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},util.ByteBuffer.prototype.getInt16=function(){var o=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,o},util.ByteBuffer.prototype.getInt24=function(){var o=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,o},util.ByteBuffer.prototype.getInt32=function(){var o=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,o},util.ByteBuffer.prototype.getInt16Le=function(){var o=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,o},util.ByteBuffer.prototype.getInt24Le=function(){var o=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,o},util.ByteBuffer.prototype.getInt32Le=function(){var o=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,o},util.ByteBuffer.prototype.getInt=function(o){var B=0;do B=(B<<o)+this.data.charCodeAt(this.read++),o-=8;while(0<o);return B},util.ByteBuffer.prototype.getBytes=function(o){var B;return o?(o=Math.min(this.length(),o),B=this.data.slice(this.read,this.read+o),this.read+=o):0===o?B="":(B=0===this.read?this.data:this.data.slice(this.read),this.clear()),B},util.ByteBuffer.prototype.bytes=function(o){return"undefined"==typeof o?this.data.slice(this.read):this.data.slice(this.read,this.read+o)},util.ByteBuffer.prototype.at=function(o){return this.data.charCodeAt(this.read+o)},util.ByteBuffer.prototype.setAt=function(o,B){this.data=this.data.substr(0,this.read+o)+String.fromCharCode(B)+this.data.substr(this.read+o+1)},util.ByteBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},util.ByteBuffer.prototype.copy=function(){var o=util.createBuffer(this.data);return o.read=this.read,o},util.ByteBuffer.prototype.compact=function(){0<this.read&&(this.data=this.data.slice(this.read),this.read=0)},util.ByteBuffer.prototype.clear=function(){this.data="",this.read=0},util.ByteBuffer.prototype.truncate=function(o){var B=Math.max(0,this.length()-o);this.data=this.data.substr(this.read,B),this.read=0},util.ByteBuffer.prototype.toHex=function(){for(var T,o="",B=this.read;B<this.data.length;++B)T=this.data.charCodeAt(B),16>T&&(o+="0"),o+=T.toString(16);return o},util.ByteBuffer.prototype.toString=function(){return util.decodeUtf8(this.bytes())},util.createBuffer=function(o,B){return B=B||"raw",void 0!==o&&"utf8"===B&&(o=util.encodeUtf8(o)),new util.ByteBuffer(o)};var prng=forge.prng={},crypto=null;prng.create=function(o){function B(N){if(32<=C.pools[0].messageLength)return E(),N();var R=32-C.pools[0].messageLength<<5;C.seedFile(R,function(L,P){return L?N(L):void(C.collect(P),E(),N())})}function T(){if(32<=C.pools[0].messageLength)return E();var N=32-C.pools[0].messageLength<<5;C.collect(C.seedFileSync(N)),E()}function E(){var N=forge.md.sha1.create();N.update(C.pools[0].digest().getBytes()),C.pools[0].start();for(var R=1,L=1;32>L;++L)R=31==R?2147483648:R<<2,0==R%C.reseeds&&(N.update(C.pools[L].digest().getBytes()),C.pools[L].start());var P=N.digest().getBytes();N.start(),N.update(P);var O=N.digest().getBytes();C.key=C.plugin.formatKey(P),C.seed=C.plugin.formatSeed(O),++C.reseeds,C.generated=0,C.time=+new Date}function I(N){var R=forge.util.createBuffer();if("undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues){var L=new Uint32Array(N/4);try{window.crypto.getRandomValues(L);for(var P=0;P<L.length;++P)R.putInt32(L[P])}catch(M){}}if(R.length()<N)for(var O,V,K,U=Math.floor(65535*Math.random());R.length()<N;){V=16807*(65535&U),O=16807*(U>>16),V+=(32767&O)<<16,V+=O>>15,V=(2147483647&V)+(V>>31),U=4294967295&V;for(var P=0;3>P;++P)K=U>>>(P<<3),K^=Math.floor(255*Math.random()),R.putByte(String.fromCharCode(255&K))}return R.getBytes()}for(var C={plugin:o,key:null,seed:null,time:null,reseeds:0,generated:0},S=o.md,A=Array(32),D=0;32>D;++D)A[D]=S.create();return C.pools=A,C.pool=0,C.generate=function(N,R){function L(M){if(M)return R(M);if(U.length()>=N)return R(null,U.getBytes(N));if(1048576<=C.generated){var G=+new Date;(null===C.time||100<G-C.time)&&(C.key=null)}if(null===C.key)return B(L);var F=P(C.key,C.seed);C.generated+=F.length,U.putBytes(F),C.key=V(P(C.key,O(C.seed))),C.seed=K(P(C.key,C.seed)),forge.util.setImmediate(L)}if(!R)return C.generateSync(N);var P=C.plugin.cipher,O=C.plugin.increment,V=C.plugin.formatKey,K=C.plugin.formatSeed,U=forge.util.createBuffer();L()},C.generateSync=function(N){for(var R=C.plugin.cipher,L=C.plugin.increment,P=C.plugin.formatKey,O=C.plugin.formatSeed,V=forge.util.createBuffer();V.length()<N;){if(1048576<=C.generated){var K=+new Date;(null===C.time||100<K-C.time)&&(C.key=null)}null===C.key&&T();var U=R(C.key,C.seed);C.generated+=U.length,V.putBytes(U),C.key=P(R(C.key,L(C.seed))),C.seed=O(R(C.key,C.seed))}return V.getBytes(N)},(C.seedFile=function(N,R){try{R(null,I(N))}catch(L){R(L)}},C.seedFileSync=I),C.collect=function(N){for(var R=N.length,L=0;L<R;++L)C.pools[C.pool].update(N.substr(L,1)),C.pool=31===C.pool?0:C.pool+1},C.collectInt=function(N,R){for(var L="",P=0;P<R;P+=8)L+=String.fromCharCode(255&N>>P);C.collect(L)},C.registerWorker=function(N){if(N===self)C.seedFile=function(L,P){function O(V){var K=V.data;K.forge&&K.forge.prng&&(self.removeEventListener("message",O),P(K.forge.prng.err,K.forge.prng.bytes))}self.addEventListener("message",O),self.postMessage({forge:{prng:{needed:L}}})};else{var R=function(P){var O=P.data;O.forge&&O.forge.prng&&C.seedFile(O.forge.prng.needed,function(V,K){N.postMessage({forge:{prng:{err:V,bytes:K}}})})};N.addEventListener("message",R)}},C};var init=!1,Nb=4,sbox,isbox,rcon,mix,imix,initialize=function(){init=!0,rcon=[0,1,2,4,8,16,32,64,128,27,54];for(var B=Array(256),T=0;128>T;++T)B[T]=T<<1,B[T+128]=283^T+128<<1;sbox=Array(256),isbox=Array(256),mix=[,,,,],imix=[,,,,];for(var T=0;4>T;++T)mix[T]=Array(256),imix[T]=Array(256);for(var C,S,A,D,N,R,L,E=0,I=0,T=0;256>T;++T){D=I^I<<1^I<<2^I<<3^I<<4,D=99^(D>>8^255&D),sbox[E]=D,isbox[D]=E,N=B[D],C=B[E],S=B[C],A=B[S],R=N<<24^D<<16^D<<8^(D^N),L=(C^S^A)<<24^(E^A)<<16^(E^S^A)<<8^(E^C^A);for(var P=0;4>P;++P)mix[P][E]=R,imix[P][D]=L,R=R<<24|R>>>8,L=L<<24|L>>>8;0==E?E=I=1:(E=C^B[B[B[C^A]]],I^=B[B[I]])}},expandKey=function(B,T){for(var I,E=B.slice(0),C=1,S=E.length,D=Nb*(S+6+1),N=S;N<D;++N)I=E[N-1],0==N%S?(I=sbox[255&I>>>16]<<24^sbox[255&I>>>8]<<16^sbox[255&I]<<8^sbox[I>>>24]^rcon[C]<<24,C++):6<S&&4==N%S&&(I=sbox[I>>>24]<<24^sbox[255&I>>>16]<<16^sbox[255&I>>>8]<<8^sbox[255&I]),E[N]=E[N-S]^I;if(T){for(var R,L=imix[0],P=imix[1],O=imix[2],V=imix[3],K=E.slice(0),D=E.length,N=0,U=D-Nb;N<D;N+=Nb,U-=Nb)if(0===N||N===D-Nb)K[N]=E[U],K[N+1]=E[U+3],K[N+2]=E[U+2],K[N+3]=E[U+1];else for(var M=0;M<Nb;++M)R=E[U+M],K[N+(3&-M)]=L[sbox[R>>>24]]^P[sbox[255&R>>>16]]^O[sbox[255&R>>>8]]^V[sbox[255&R]];E=K}return E};forge.aes._expandKey=function(o,B){return init||initialize(),expandKey(o,B)};var _updateBlock=function(B,T,E,I){var C=B.length/4-1,S,A,D,N,R;I?(S=imix[0],A=imix[1],D=imix[2],N=imix[3],R=isbox):(S=mix[0],A=mix[1],D=mix[2],N=mix[3],R=sbox);var L,P,O,V,K,U,M;L=T[0]^B[0],P=T[I?3:1]^B[1],O=T[2]^B[2],V=T[I?1:3]^B[3];for(var G=3,F=1;F<C;++F)K=S[L>>>24]^A[255&P>>>16]^D[255&O>>>8]^N[255&V]^B[++G],U=S[P>>>24]^A[255&O>>>16]^D[255&V>>>8]^N[255&L]^B[++G],M=S[O>>>24]^A[255&V>>>16]^D[255&L>>>8]^N[255&P]^B[++G],V=S[V>>>24]^A[255&L>>>16]^D[255&P>>>8]^N[255&O]^B[++G],L=K,P=U,O=M;E[0]=R[L>>>24]<<24^R[255&P>>>16]<<16^R[255&O>>>8]<<8^R[255&V]^B[++G],E[I?3:1]=R[P>>>24]<<24^R[255&O>>>16]<<16^R[255&V>>>8]<<8^R[255&L]^B[++G],E[2]=R[O>>>24]<<24^R[255&V>>>16]<<16^R[255&L>>>8]<<8^R[255&P]^B[++G],E[I?1:3]=R[V>>>24]<<24^R[255&L>>>16]<<16^R[255&P>>>8]<<8^R[255&O]^B[++G]};forge.aes._updateBlock=_updateBlock;var prng_aes={},_prng_aes_output=[,,,,],_prng_aes_buffer=forge.util.createBuffer();prng_aes.formatKey=function(o){var B=forge.util.createBuffer(o);return o=[,,,,],o[0]=B.getInt32(),o[1]=B.getInt32(),o[2]=B.getInt32(),o[3]=B.getInt32(),forge.aes._expandKey(o,!1)},prng_aes.formatSeed=function(o){var B=forge.util.createBuffer(o);return o=[,,,,],o[0]=B.getInt32(),o[1]=B.getInt32(),o[2]=B.getInt32(),o[3]=B.getInt32(),o},prng_aes.cipher=function(o,B){return forge.aes._updateBlock(o,B,_prng_aes_output,!1),_prng_aes_buffer.putInt32(_prng_aes_output[0]),_prng_aes_buffer.putInt32(_prng_aes_output[1]),_prng_aes_buffer.putInt32(_prng_aes_output[2]),_prng_aes_buffer.putInt32(_prng_aes_output[3]),_prng_aes_buffer.getBytes()},prng_aes.increment=function(o){return++o[3],o},prng_aes.md=forge.md.sha1;var _ctx=forge.prng.create(prng_aes);if(("undefined"==typeof window||!window.crypto||!window.crypto.getRandomValues)&&("undefined"!=typeof window&&void 0!==window.document,_ctx.collectInt(+new Date,32),"undefined"!=typeof navigator)){var _navBytes="";for(var key in navigator)try{"string"==typeof navigator[key]&&(_navBytes+=navigator[key])}catch(o){}_ctx.collect(_navBytes),_navBytes=null}forge.random=_ctx,forge.random.getBytes=function(o,B){return forge.random.generate(o,B)},forge.pki.rsa.createKeyPairGenerationState=function(o,B){"string"==typeof o&&(o=parseInt(o,10)),o=o||1024;var E={state:0,bits:o,rng:{nextBytes:function(C){for(var S=forge.random.getBytes(C.length),A=0;A<C.length;++A)C[A]=S.charCodeAt(A)}},eInt:B||65537,e:new BigInteger(null),p:null,q:null,qBits:o>>1,pBits:o-(o>>1),pqState:0,num:null,keys:null};return E.e.fromInt(E.eInt),E};var dbits,canary=0xdeadbeefcafe,j_lm=15715070==(16777215&canary);function BigInteger(o,B,T){this.data=[],null!=o&&("number"==typeof o?this.fromNumber(o,B,T):null==B&&"string"!=typeof o?this.fromString(o,256):this.fromString(o,B))}function nbi(){return new BigInteger(null)}function am1(o,B,T,E,I,C){for(;0<=--C;){var S=B*this.data[o++]+T.data[E]+I;I=Math.floor(S/67108864),T.data[E++]=67108863&S}return I}function am2(o,B,T,E,I,C){for(var S=32767&B,A=B>>15;0<=--C;){var D=32767&this.data[o],N=this.data[o++]>>15,R=A*D+N*S;D=S*D+((32767&R)<<15)+T.data[E]+(1073741823&I),I=(D>>>30)+(R>>>15)+A*N+(I>>>30),T.data[E++]=1073741823&D}return I}function am3(o,B,T,E,I,C){for(var S=16383&B,A=B>>14;0<=--C;){var D=16383&this.data[o],N=this.data[o++]>>14,R=A*D+N*S;D=S*D+((16383&R)<<14)+T.data[E]+I,I=(D>>28)+(R>>14)+A*N,T.data[E++]=268435455&D}return I}"undefined"==typeof navigator?(BigInteger.prototype.am=am3,dbits=28):"Microsoft Internet Explorer"==navigator.appName?(BigInteger.prototype.am=am2,dbits=30):"Netscape"!=navigator.appName?(BigInteger.prototype.am=am1,dbits=26):(BigInteger.prototype.am=am3,dbits=28),BigInteger.prototype.DB=dbits,BigInteger.prototype.DM=(1<<dbits)-1,BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP),BigInteger.prototype.F1=BI_FP-dbits,BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=[],rr,vv;for(rr="0".charCodeAt(0),vv=0;9>=vv;++vv)BI_RC[rr++]=vv;for(rr="a".charCodeAt(0),vv=10;36>vv;++vv)BI_RC[rr++]=vv;for(rr="A".charCodeAt(0),vv=10;36>vv;++vv)BI_RC[rr++]=vv;function int2char(o){return BI_RM.charAt(o)}function intAt(o,B){var T=BI_RC[o.charCodeAt(B)];return null==T?-1:T}function bnpCopyTo(o){for(var B=this.t-1;0<=B;--B)o.data[B]=this.data[B];o.t=this.t,o.s=this.s}function bnpFromInt(o){this.t=1,this.s=0>o?-1:0,0<o?this.data[0]=o:-1>o?this.data[0]=o+DV:this.t=0}function nbv(o){var B=nbi();return B.fromInt(o),B}function bnpFromString(o,B){var T;if(16==B)T=4;else if(8==B)T=3;else if(256==B)T=8;else if(2==B)T=1;else if(32==B)T=5;else if(4==B)T=2;else return void this.fromRadix(o,B);this.t=0,this.s=0;for(var S,E=o.length,I=!1,C=0;0<=--E;){if(S=8==T?255&o[E]:intAt(o,E),0>S){"-"==o.charAt(E)&&(I=!0);continue}I=!1,0==C?this.data[this.t++]=S:C+T>this.DB?(this.data[this.t-1]|=(S&(1<<this.DB-C)-1)<<C,this.data[this.t++]=S>>this.DB-C):this.data[this.t-1]|=S<<C,C+=T,C>=this.DB&&(C-=this.DB)}8==T&&0!=(128&o[0])&&(this.s=-1,0<C&&(this.data[this.t-1]|=(1<<this.DB-C)-1<<C)),this.clamp(),I&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var o=this.s&this.DM;0<this.t&&this.data[this.t-1]==o;)--this.t}function bnToString(o){if(0>this.s)return"-"+this.negate().toString(o);var B;if(16==o)B=4;else if(8==o)B=3;else if(2==o)B=1;else if(32==o)B=5;else if(4==o)B=2;else return this.toRadix(o);var E,T=(1<<B)-1,I=!1,C="",S=this.t,A=this.DB-S*this.DB%B;if(0<S--)for(A<this.DB&&0<(E=this.data[S]>>A)&&(I=!0,C=int2char(E));0<=S;)A<B?(E=(this.data[S]&(1<<A)-1)<<B-A,E|=this.data[--S]>>(A+=this.DB-B)):(E=this.data[S]>>(A-=B)&T,0>=A&&(A+=this.DB,--S)),0<E&&(I=!0),I&&(C+=int2char(E));return I?C:"0"}function bnNegate(){var o=nbi();return BigInteger.ZERO.subTo(this,o),o}function bnAbs(){return 0>this.s?this.negate():this}function bnCompareTo(o){var B=this.s-o.s;if(0!=B)return B;var T=this.t;if(B=T-o.t,0!=B)return 0>this.s?-B:B;for(;0<=--T;)if(0!=(B=this.data[T]-o.data[T]))return B;return 0}function nbits(o){var T,B=1;return 0!=(T=o>>>16)&&(o=T,B+=16),0!=(T=o>>8)&&(o=T,B+=8),0!=(T=o>>4)&&(o=T,B+=4),0!=(T=o>>2)&&(o=T,B+=2),0!=(T=o>>1)&&(o=T,B+=1),B}function bnBitLength(){return 0>=this.t?0:this.DB*(this.t-1)+nbits(this.data[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(o,B){var T;for(T=this.t-1;0<=T;--T)B.data[T+o]=this.data[T];for(T=o-1;0<=T;--T)B.data[T]=0;B.t=this.t+o,B.s=this.s}function bnpDRShiftTo(o,B){for(var T=o;T<this.t;++T)B.data[T-o]=this.data[T];B.t=Math.max(this.t-o,0),B.s=this.s}function bnpLShiftTo(o,B){var T=o%this.DB,E=this.DB-T,C=Math.floor(o/this.DB),S=this.s<<T&this.DM,A;for(A=this.t-1;0<=A;--A)B.data[A+C+1]=this.data[A]>>E|S,S=(this.data[A]&(1<<E)-1)<<T;for(A=C-1;0<=A;--A)B.data[A]=0;B.data[C]=S,B.t=this.t+C+1,B.s=this.s,B.clamp()}function bnpRShiftTo(o,B){B.s=this.s;var T=Math.floor(o/this.DB);if(T>=this.t)return void(B.t=0);var E=o%this.DB,I=this.DB-E,C=(1<<E)-1;B.data[0]=this.data[T]>>E;for(var S=T+1;S<this.t;++S)B.data[S-T-1]|=(this.data[S]&C)<<I,B.data[S-T]=this.data[S]>>E;0<E&&(B.data[this.t-T-1]|=(this.s&C)<<I),B.t=this.t-T,B.clamp()}function bnpSubTo(o,B){for(var T=0,E=0,I=Math.min(o.t,this.t);T<I;)E+=this.data[T]-o.data[T],B.data[T++]=E&this.DM,E>>=this.DB;if(o.t<this.t){for(E-=o.s;T<this.t;)E+=this.data[T],B.data[T++]=E&this.DM,E>>=this.DB;E+=this.s}else{for(E+=this.s;T<o.t;)E-=o.data[T],B.data[T++]=E&this.DM,E>>=this.DB;E-=o.s}B.s=0>E?-1:0,-1>E?B.data[T++]=this.DV+E:0<E&&(B.data[T++]=E),B.t=T,B.clamp()}function bnpMultiplyTo(o,B){var T=this.abs(),E=o.abs(),I=T.t;for(B.t=I+E.t;0<=--I;)B.data[I]=0;for(I=0;I<E.t;++I)B.data[I+T.t]=T.am(0,E.data[I],B,I,0,T.t);B.s=0,B.clamp(),this.s!=o.s&&BigInteger.ZERO.subTo(B,B)}function bnpSquareTo(o){for(var B=this.abs(),T=o.t=2*B.t;0<=--T;)o.data[T]=0;for(T=0;T<B.t-1;++T){var E=B.am(T,B.data[T],o,2*T,0,1);(o.data[T+B.t]+=B.am(T+1,2*B.data[T],o,2*T+1,E,B.t-T-1))>=B.DV&&(o.data[T+B.t]-=B.DV,o.data[T+B.t+1]=1)}0<o.t&&(o.data[o.t-1]+=B.am(T,B.data[T],o,2*T,0,1)),o.s=0,o.clamp()}function bnpDivRemTo(o,B,T){var E=o.abs();if(!(0>=E.t)){var I=this.abs();if(I.t<E.t)return null!=B&&B.fromInt(0),void(null!=T&&this.copyTo(T));null==T&&(T=nbi());var C=nbi(),S=this.s,A=o.s,D=this.DB-nbits(E.data[E.t-1]);0<D?(E.lShiftTo(D,C),I.lShiftTo(D,T)):(E.copyTo(C),I.copyTo(T));var N=C.t,R=C.data[N-1];if(0!=R){var L=R*(1<<this.F1)+(1<N?C.data[N-2]>>this.F2:0),P=this.FV/L,O=(1<<this.F1)/L,V=1<<this.F2,K=T.t,U=K-N,M=null==B?nbi():B;for(C.dlShiftTo(U,M),0<=T.compareTo(M)&&(T.data[T.t++]=1,T.subTo(M,T)),BigInteger.ONE.dlShiftTo(N,M),M.subTo(C,C);C.t<N;)C.data[C.t++]=0;for(;0<=--U;){var G=T.data[--K]==R?this.DM:Math.floor(T.data[K]*P+(T.data[K-1]+V)*O);if((T.data[K]+=C.am(0,G,T,U,0,N))<G)for(C.dlShiftTo(U,M),T.subTo(M,T);T.data[K]<--G;)T.subTo(M,T)}null!=B&&(T.drShiftTo(N,B),S!=A&&BigInteger.ZERO.subTo(B,B)),T.t=N,T.clamp(),0<D&&T.rShiftTo(D,T),0>S&&BigInteger.ZERO.subTo(T,T)}}}function bnMod(o){var B=nbi();return this.abs().divRemTo(o,null,B),0>this.s&&0<B.compareTo(BigInteger.ZERO)&&o.subTo(B,B),B}function Classic(o){this.m=o}function cConvert(o){return 0>o.s||0<=o.compareTo(this.m)?o.mod(this.m):o}function cRevert(o){return o}function cReduce(o){o.divRemTo(this.m,null,o)}function cMulTo(o,B,T){o.multiplyTo(B,T),this.reduce(T)}function cSqrTo(o,B){o.squareTo(B),this.reduce(B)}Classic.prototype.convert=cConvert,Classic.prototype.revert=cRevert,Classic.prototype.reduce=cReduce,Classic.prototype.mulTo=cMulTo,Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if(1>this.t)return 0;var o=this.data[0];if(0==(1&o))return 0;var B=3&o;return B=15&B*(2-(15&o)*B),B=255&B*(2-(255&o)*B),B=65535&B*(2-(65535&(65535&o)*B)),B=B*(2-o*B%this.DV)%this.DV,0<B?this.DV-B:-B}function Montgomery(o){this.m=o,this.mp=o.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<o.DB-15)-1,this.mt2=2*o.t}function montConvert(o){var B=nbi();return o.abs().dlShiftTo(this.m.t,B),B.divRemTo(this.m,null,B),0>o.s&&0<B.compareTo(BigInteger.ZERO)&&this.m.subTo(B,B),B}function montRevert(o){var B=nbi();return o.copyTo(B),this.reduce(B),B}function montReduce(o){for(;o.t<=this.mt2;)o.data[o.t++]=0;for(var B=0;B<this.m.t;++B){var T=32767&o.data[B],E=T*this.mpl+((T*this.mph+(o.data[B]>>15)*this.mpl&this.um)<<15)&o.DM;for(T=B+this.m.t,o.data[T]+=this.m.am(0,E,o,B,0,this.m.t);o.data[T]>=o.DV;)o.data[T]-=o.DV,o.data[++T]++}o.clamp(),o.drShiftTo(this.m.t,o),0<=o.compareTo(this.m)&&o.subTo(this.m,o)}function montSqrTo(o,B){o.squareTo(B),this.reduce(B)}function montMulTo(o,B,T){o.multiplyTo(B,T),this.reduce(T)}Montgomery.prototype.convert=montConvert,Montgomery.prototype.revert=montRevert,Montgomery.prototype.reduce=montReduce,Montgomery.prototype.mulTo=montMulTo,Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return 0==(0<this.t?1&this.data[0]:this.s)}function bnpExp(o,B){if(4294967295<o||1>o)return BigInteger.ONE;var T=nbi(),E=nbi(),I=B.convert(this),C=nbits(o)-1;for(I.copyTo(T);0<=--C;)if(B.sqrTo(T,E),0<(o&1<<C))B.mulTo(E,I,T);else{var S=T;T=E,E=S}return B.revert(T)}function bnModPowInt(o,B){var T;return T=256>o||B.isEven()?new Classic(B):new Montgomery(B),this.exp(o,T)}BigInteger.prototype.copyTo=bnpCopyTo,BigInteger.prototype.fromInt=bnpFromInt,BigInteger.prototype.fromString=bnpFromString,BigInteger.prototype.clamp=bnpClamp,BigInteger.prototype.dlShiftTo=bnpDLShiftTo,BigInteger.prototype.drShiftTo=bnpDRShiftTo,BigInteger.prototype.lShiftTo=bnpLShiftTo,BigInteger.prototype.rShiftTo=bnpRShiftTo,BigInteger.prototype.subTo=bnpSubTo,BigInteger.prototype.multiplyTo=bnpMultiplyTo,BigInteger.prototype.squareTo=bnpSquareTo,BigInteger.prototype.divRemTo=bnpDivRemTo,BigInteger.prototype.invDigit=bnpInvDigit,BigInteger.prototype.isEven=bnpIsEven,BigInteger.prototype.exp=bnpExp,BigInteger.prototype.toString=bnToString,BigInteger.prototype.negate=bnNegate,BigInteger.prototype.abs=bnAbs,BigInteger.prototype.compareTo=bnCompareTo,BigInteger.prototype.bitLength=bnBitLength,BigInteger.prototype.mod=bnMod,BigInteger.prototype.modPowInt=bnModPowInt,BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1);function bnClone(){var o=nbi();return this.copyTo(o),o}function bnIntValue(){if(0>this.s){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function bnByteValue(){return 0==this.t?this.s:this.data[0]<<24>>24}function bnShortValue(){return 0==this.t?this.s:this.data[0]<<16>>16}function bnpChunkSize(o){return Math.floor(Math.LN2*this.DB/Math.log(o))}function bnSigNum(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this.data[0]?0:1}function bnpToRadix(o){if(null==o&&(o=10),0==this.signum()||2>o||36<o)return"0";var B=this.chunkSize(o),T=Math.pow(o,B),E=nbv(T),I=nbi(),C=nbi(),S="";for(this.divRemTo(E,I,C);0<I.signum();)S=(T+C.intValue()).toString(o).substr(1)+S,I.divRemTo(E,I,C);return C.intValue().toString(o)+S}function bnpFromRadix(o,B){this.fromInt(0),null==B&&(B=10);for(var D,T=this.chunkSize(B),E=Math.pow(B,T),I=!1,C=0,S=0,A=0;A<o.length;++A){if(D=intAt(o,A),0>D){"-"==o.charAt(A)&&0==this.signum()&&(I=!0);continue}S=B*S+D,++C>=T&&(this.dMultiply(E),this.dAddOffset(S,0),C=0,S=0)}0<C&&(this.dMultiply(Math.pow(B,C)),this.dAddOffset(S,0)),I&&BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(o,B,T){if(!("number"==typeof B)){var E=[],I=7&o;E.length=(o>>3)+1,B.nextBytes(E),0<I?E[0]&=(1<<I)-1:E[0]=0,this.fromString(E,256)}else if(2>o)this.fromInt(1);else for(this.fromNumber(o,T),this.testBit(o-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(o-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(B);)this.dAddOffset(2,0),this.bitLength()>o&&this.subTo(BigInteger.ONE.shiftLeft(o-1),this)}function bnToByteArray(){var o=this.t,B=[];B[0]=this.s;var E,T=this.DB-o*this.DB%8,I=0;if(0<o--)for(T<this.DB&&(E=this.data[o]>>T)!=(this.s&this.DM)>>T&&(B[I++]=E|this.s<<this.DB-T);0<=o;)8>T?(E=(this.data[o]&(1<<T)-1)<<8-T,E|=this.data[--o]>>(T+=this.DB-8)):(E=255&this.data[o]>>(T-=8),0>=T&&(T+=this.DB,--o)),0!=(128&E)&&(E|=-256),0==I&&(128&this.s)!=(128&E)&&++I,(0<I||E!=this.s)&&(B[I++]=E);return B}function bnEquals(o){return 0==this.compareTo(o)}function bnMin(o){return 0>this.compareTo(o)?this:o}function bnMax(o){return 0<this.compareTo(o)?this:o}function bnpBitwiseTo(o,B,T){var E,I,C=Math.min(o.t,this.t);for(E=0;E<C;++E)T.data[E]=B(this.data[E],o.data[E]);if(o.t<this.t){for(I=o.s&this.DM,E=C;E<this.t;++E)T.data[E]=B(this.data[E],I);T.t=this.t}else{for(I=this.s&this.DM,E=C;E<o.t;++E)T.data[E]=B(I,o.data[E]);T.t=o.t}T.s=B(this.s,o.s),T.clamp()}function op_and(o,B){return o&B}function bnAnd(o){var B=nbi();return this.bitwiseTo(o,op_and,B),B}function op_or(o,B){return o|B}function bnOr(o){var B=nbi();return this.bitwiseTo(o,op_or,B),B}function op_xor(o,B){return o^B}function bnXor(o){var B=nbi();return this.bitwiseTo(o,op_xor,B),B}function op_andnot(o,B){return o&~B}function bnAndNot(o){var B=nbi();return this.bitwiseTo(o,op_andnot,B),B}function bnNot(){for(var o=nbi(),B=0;B<this.t;++B)o.data[B]=this.DM&~this.data[B];return o.t=this.t,o.s=~this.s,o}function bnShiftLeft(o){var B=nbi();return 0>o?this.rShiftTo(-o,B):this.lShiftTo(o,B),B}function bnShiftRight(o){var B=nbi();return 0>o?this.lShiftTo(-o,B):this.rShiftTo(o,B),B}function lbit(o){if(0==o)return-1;var B=0;return 0==(65535&o)&&(o>>=16,B+=16),0==(255&o)&&(o>>=8,B+=8),0==(15&o)&&(o>>=4,B+=4),0==(3&o)&&(o>>=2,B+=2),0==(1&o)&&++B,B}function bnGetLowestSetBit(){for(var o=0;o<this.t;++o)if(0!=this.data[o])return o*this.DB+lbit(this.data[o]);return 0>this.s?this.t*this.DB:-1}function cbit(o){for(var B=0;0!=o;)o&=o-1,++B;return B}function bnBitCount(){for(var o=0,B=this.s&this.DM,T=0;T<this.t;++T)o+=cbit(this.data[T]^B);return o}function bnTestBit(o){var B=Math.floor(o/this.DB);return B>=this.t?0!=this.s:0!=(this.data[B]&1<<o%this.DB)}function bnpChangeBit(o,B){var T=BigInteger.ONE.shiftLeft(o);return this.bitwiseTo(T,B,T),T}function bnSetBit(o){return this.changeBit(o,op_or)}function bnClearBit(o){return this.changeBit(o,op_andnot)}function bnFlipBit(o){return this.changeBit(o,op_xor)}function bnpAddTo(o,B){for(var T=0,E=0,I=Math.min(o.t,this.t);T<I;)E+=this.data[T]+o.data[T],B.data[T++]=E&this.DM,E>>=this.DB;if(o.t<this.t){for(E+=o.s;T<this.t;)E+=this.data[T],B.data[T++]=E&this.DM,E>>=this.DB;E+=this.s}else{for(E+=this.s;T<o.t;)E+=o.data[T],B.data[T++]=E&this.DM,E>>=this.DB;E+=o.s}B.s=0>E?-1:0,0<E?B.data[T++]=E:-1>E&&(B.data[T++]=this.DV+E),B.t=T,B.clamp()}function bnAdd(o){var B=nbi();return this.addTo(o,B),B}function bnSubtract(o){var B=nbi();return this.subTo(o,B),B}function bnMultiply(o){var B=nbi();return this.multiplyTo(o,B),B}function bnDivide(o){var B=nbi();return this.divRemTo(o,B,null),B}function bnRemainder(o){var B=nbi();return this.divRemTo(o,null,B),B}function bnDivideAndRemainder(o){var B=nbi(),T=nbi();return this.divRemTo(o,B,T),[B,T]}function bnpDMultiply(o){this.data[this.t]=this.am(0,o-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(o,B){if(0!=o){for(;this.t<=B;)this.data[this.t++]=0;for(this.data[B]+=o;this.data[B]>=this.DV;)this.data[B]-=this.DV,++B>=this.t&&(this.data[this.t++]=0),++this.data[B]}}function NullExp(){}function nNop(o){return o}function nMulTo(o,B,T){o.multiplyTo(B,T)}function nSqrTo(o,B){o.squareTo(B)}NullExp.prototype.convert=nNop,NullExp.prototype.revert=nNop,NullExp.prototype.mulTo=nMulTo,NullExp.prototype.sqrTo=nSqrTo;function bnPow(o){return this.exp(o,new NullExp)}function bnpMultiplyLowerTo(o,B,T){var E=Math.min(this.t+o.t,B);for(T.s=0,T.t=E;0<E;)T.data[--E]=0;var I;for(I=T.t-this.t;E<I;++E)T.data[E+this.t]=this.am(0,o.data[E],T,E,0,this.t);for(I=Math.min(o.t,B);E<I;++E)this.am(0,o.data[E],T,E,0,B-E);T.clamp()}function bnpMultiplyUpperTo(o,B,T){--B;var E=T.t=this.t+o.t-B;for(T.s=0;0<=--E;)T.data[E]=0;for(E=Math.max(B-this.t,0);E<o.t;++E)T.data[this.t+E-B]=this.am(B-E,o.data[E],T,0,0,this.t+E-B);T.clamp(),T.drShiftTo(1,T)}function Barrett(o){this.r2=nbi(),this.q3=nbi(),BigInteger.ONE.dlShiftTo(2*o.t,this.r2),this.mu=this.r2.divide(o),this.m=o}function barrettConvert(o){if(0>o.s||o.t>2*this.m.t)return o.mod(this.m);if(0>o.compareTo(this.m))return o;var B=nbi();return o.copyTo(B),this.reduce(B),B}function barrettRevert(o){return o}function barrettReduce(o){for(o.drShiftTo(this.m.t-1,this.r2),o.t>this.m.t+1&&(o.t=this.m.t+1,o.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>o.compareTo(this.r2);)o.dAddOffset(1,this.m.t+1);for(o.subTo(this.r2,o);0<=o.compareTo(this.m);)o.subTo(this.m,o)}function barrettSqrTo(o,B){o.squareTo(B),this.reduce(B)}function barrettMulTo(o,B,T){o.multiplyTo(B,T),this.reduce(T)}Barrett.prototype.convert=barrettConvert,Barrett.prototype.revert=barrettRevert,Barrett.prototype.reduce=barrettReduce,Barrett.prototype.mulTo=barrettMulTo,Barrett.prototype.sqrTo=barrettSqrTo;function bnModPow(o,B){var E,C,T=o.bitLength(),I=nbv(1);if(0>=T)return I;E=18>T?1:48>T?3:144>T?4:768>T?5:6,C=8>T?new Classic(B):B.isEven()?new Barrett(B):new Montgomery(B);var S=[],A=3,D=E-1,N=(1<<E)-1;if(S[1]=C.convert(this),1<E){var R=nbi();for(C.sqrTo(S[1],R);A<=N;)S[A]=nbi(),C.mulTo(R,S[A-2],S[A]),A+=2}var P,K,L=o.t-1,O=!0,V=nbi();for(T=nbits(o.data[L])-1;0<=L;){for(T>=D?P=o.data[L]>>T-D&N:(P=(o.data[L]&(1<<T+1)-1)<<D-T,0<L&&(P|=o.data[L-1]>>this.DB+T-D)),A=E;0==(1&P);)P>>=1,--A;if(0>(T-=A)&&(T+=this.DB,--L),O)S[P].copyTo(I),O=!1;else{for(;1<A;)C.sqrTo(I,V),C.sqrTo(V,I),A-=2;0<A?C.sqrTo(I,V):(K=I,I=V,V=K),C.mulTo(V,S[P],I)}for(;0<=L&&0==(o.data[L]&1<<T);)C.sqrTo(I,V),K=I,I=V,V=K,0>--T&&(T=this.DB-1,--L)}return C.revert(I)}function bnGCD(o){var B=0>this.s?this.negate():this.clone(),T=0>o.s?o.negate():o.clone();if(0>B.compareTo(T)){var E=B;B=T,T=E}var I=B.getLowestSetBit(),C=T.getLowestSetBit();if(0>C)return B;for(I<C&&(C=I),0<C&&(B.rShiftTo(C,B),T.rShiftTo(C,T));0<B.signum();)0<(I=B.getLowestSetBit())&&B.rShiftTo(I,B),0<(I=T.getLowestSetBit())&&T.rShiftTo(I,T),0<=B.compareTo(T)?(B.subTo(T,B),B.rShiftTo(1,B)):(T.subTo(B,T),T.rShiftTo(1,T));return 0<C&&T.lShiftTo(C,T),T}function bnpModInt(o){if(0>=o)return 0;var B=this.DV%o,T=0>this.s?o-1:0;if(0<this.t)if(0==B)T=this.data[0]%o;else for(var E=this.t-1;0<=E;--E)T=(B*T+this.data[E])%o;return T}function bnModInverse(o){var B=o.isEven();if(this.isEven()&&B||0==o.signum())return BigInteger.ZERO;for(var T=o.clone(),E=this.clone(),I=nbv(1),C=nbv(0),S=nbv(0),A=nbv(1);0!=T.signum();){for(;T.isEven();)T.rShiftTo(1,T),B?((!I.isEven()||!C.isEven())&&(I.addTo(this,I),C.subTo(o,C)),I.rShiftTo(1,I)):!C.isEven()&&C.subTo(o,C),C.rShiftTo(1,C);for(;E.isEven();)E.rShiftTo(1,E),B?((!S.isEven()||!A.isEven())&&(S.addTo(this,S),A.subTo(o,A)),S.rShiftTo(1,S)):!A.isEven()&&A.subTo(o,A),A.rShiftTo(1,A);0<=T.compareTo(E)?(T.subTo(E,T),B&&I.subTo(S,I),C.subTo(A,C)):(E.subTo(T,E),B&&S.subTo(I,S),A.subTo(C,A))}if(0!=E.compareTo(BigInteger.ONE))return BigInteger.ZERO;if(0<=A.compareTo(o))return A.subtract(o);if(0>A.signum())A.addTo(o,A);else return A;return 0>A.signum()?A.add(o):A}var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],lplim=67108864/lowprimes[lowprimes.length-1];function bnIsProbablePrime(o){var B,T=this.abs();if(1==T.t&&T.data[0]<=lowprimes[lowprimes.length-1]){for(B=0;B<lowprimes.length;++B)if(T.data[0]==lowprimes[B])return!0;return!1}if(T.isEven())return!1;for(B=1;B<lowprimes.length;){for(var E=lowprimes[B],I=B+1;I<lowprimes.length&&E<lplim;)E*=lowprimes[I++];for(E=T.modInt(E);B<I;)if(0==E%lowprimes[B++])return!1}return T.millerRabin(o)}function bnpMillerRabin(o){var B=this.subtract(BigInteger.ONE),T=B.getLowestSetBit();if(0>=T)return!1;var E=B.shiftRight(T);o=o+1>>1,o>lowprimes.length&&(o=lowprimes.length);for(var I=nbi(),C=0;C<o;++C){I.fromInt(lowprimes[C]);var S=I.modPow(E,this);if(0!=S.compareTo(BigInteger.ONE)&&0!=S.compareTo(B)){for(var A=1;A++<T&&0!=S.compareTo(B);)if(S=S.modPowInt(2,this),0==S.compareTo(BigInteger.ONE))return!1;if(0!=S.compareTo(B))return!1}}return!0}BigInteger.prototype.chunkSize=bnpChunkSize,BigInteger.prototype.toRadix=bnpToRadix,BigInteger.prototype.fromRadix=bnpFromRadix,BigInteger.prototype.fromNumber=bnpFromNumber,BigInteger.prototype.bitwiseTo=bnpBitwiseTo,BigInteger.prototype.changeBit=bnpChangeBit,BigInteger.prototype.addTo=bnpAddTo,BigInteger.prototype.dMultiply=bnpDMultiply,BigInteger.prototype.dAddOffset=bnpDAddOffset,BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo,BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo,BigInteger.prototype.modInt=bnpModInt,BigInteger.prototype.millerRabin=bnpMillerRabin,BigInteger.prototype.clone=bnClone,BigInteger.prototype.intValue=bnIntValue,BigInteger.prototype.byteValue=bnByteValue,BigInteger.prototype.shortValue=bnShortValue,BigInteger.prototype.signum=bnSigNum,BigInteger.prototype.toByteArray=bnToByteArray,BigInteger.prototype.equals=bnEquals,BigInteger.prototype.min=bnMin,BigInteger.prototype.max=bnMax,BigInteger.prototype.and=bnAnd,BigInteger.prototype.or=bnOr,BigInteger.prototype.xor=bnXor,BigInteger.prototype.andNot=bnAndNot,BigInteger.prototype.not=bnNot,BigInteger.prototype.shiftLeft=bnShiftLeft,BigInteger.prototype.shiftRight=bnShiftRight,BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit,BigInteger.prototype.bitCount=bnBitCount,BigInteger.prototype.testBit=bnTestBit,BigInteger.prototype.setBit=bnSetBit,BigInteger.prototype.clearBit=bnClearBit,BigInteger.prototype.flipBit=bnFlipBit,BigInteger.prototype.add=bnAdd,BigInteger.prototype.subtract=bnSubtract,BigInteger.prototype.multiply=bnMultiply,BigInteger.prototype.divide=bnDivide,BigInteger.prototype.remainder=bnRemainder,BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder,BigInteger.prototype.modPow=bnModPow,BigInteger.prototype.modInverse=bnModInverse,BigInteger.prototype.pow=bnPow,BigInteger.prototype.gcd=bnGCD,BigInteger.prototype.isProbablePrime=bnIsProbablePrime,forge.jsbn=forge.jsbn||{},forge.jsbn.BigInteger=BigInteger;var util=forge.util=forge.util||{};"undefined"!=typeof process&&process.nextTick?(util.nextTick=process.nextTick,util.setImmediate="function"==typeof setImmediate?setImmediate:util.nextTick):"function"==typeof setImmediate?(util.setImmediate=setImmediate,util.nextTick=function(o){return setImmediate(o)}):(util.setImmediate=function(o){setTimeout(o,0)},util.nextTick=util.setImmediate);var _modPow=function(B,T,E){var I;if(E)I=B.modPow(T.e,T.n);else{T.dP||(T.dP=T.d.mod(T.p.subtract(BigInteger.ONE))),T.dQ||(T.dQ=T.d.mod(T.q.subtract(BigInteger.ONE))),T.qInv||(T.qInv=T.q.modInverse(T.p));for(var C=B.mod(T.p).modPow(T.dP,T.p),S=B.mod(T.q).modPow(T.dQ,T.q);0>C.compareTo(S);)C=C.add(T.p);I=C.subtract(S).multiply(T.qInv).mod(T.p).multiply(T.q).add(S)}return I};util.encodeUtf8=function(o){return unescape(encodeURIComponent(o))},util.decodeUtf8=function(o){return decodeURIComponent(escape(o))},util.createBuffer=function(o,B){return B=B||"raw",void 0!==o&&"utf8"===B&&(o=util.encodeUtf8(o)),new util.ByteBuffer(o)},util.hexToBytes=function(o){var B="",T=0;for(!0&o.length&&(T=1,B+=String.fromCharCode(parseInt(o[0],16)));T<o.length;T+=2)B+=String.fromCharCode(parseInt(o.substr(T,2),16));return B},pki.rsa.decrypt=function(o,B,T,E){var I=Math.ceil(B.n.bitLength()/8);if(o.length!=I)throw{message:"Encrypted message length is invalid.",length:o.length,expected:I};for(var C=new BigInteger(forge.util.createBuffer(o).toHex(),16),S=_modPow(C,B,T),A=S.toString(16),D=forge.util.createBuffer(),N=I-Math.ceil(A.length/2);0<N;)D.putByte(0),--N;if(D.putBytes(forge.util.hexToBytes(A)),!1!==E){var R=D.getByte(),L=D.getByte();if(0!==R||T&&0!==L&&1!==L||!T&&2!=L||T&&0===L&&"undefined"==typeof E)throw{message:"Encryption block is invalid."};var P=0;if(0===L){P=I-3-E;for(var O=0;O<P;++O)if(0!==D.getByte())throw{message:"Encryption block is invalid."}}else if(1===L)for(P=0;1<D.length();){if(255!==D.getByte()){--D.read;break}++P}else if(2===L)for(P=0;1<D.length();){if(0===D.getByte()){--D.read;break}++P}var V=D.getByte();if(0!==V||P!=I-3-D.length())throw{message:"Encryption block is invalid."}}return D.getBytes()},pki.rsa.encrypt=function(o,B,T){var E=T,I=forge.util.createBuffer(),C=Math.ceil(B.n.bitLength()/8);if(!1!==T&&!0!==T){if(o.length>C-11)throw{message:"Message is too long to encrypt.",length:o.length,max:C-11};I.putByte(0),I.putByte(T);var A,S=C-3-o.length;if(0===T||1===T){E=!1,A=0===T?0:255;for(var D=0;D<S;++D)I.putByte(A)}else{E=!0;for(var D=0;D<S;++D)A=Math.floor(255*Math.random())+1,I.putByte(A)}I.putByte(0)}I.putBytes(o);for(var N=new BigInteger(I.toHex(),16),R=_modPow(N,B,E),L=R.toString(16),P=forge.util.createBuffer(),O=C-Math.ceil(L.length/2);0<O;)P.putByte(0),--O;return P.putBytes(forge.util.hexToBytes(L)),P.getBytes()},pki.rsa.setPrivateKey=function(o,B,T,E,I,C,S,A){var D={n:o,e:B,d:T,p:E,q:I,dP:C,dQ:S,qInv:A};return D.decrypt=function(N){return pki.rsa.decrypt(N,D,!1)},D.sign=function(N,R){var L=!1;void 0===R&&(R={encode:emsaPkcs1v15encode},L=1);var P=R.encode(N,D.n.bitLength());return pki.rsa.encrypt(P,D,L)},D};var _getValueLength=function(B){var T=B.getByte();if(128!=T){var E;return E=128&T?B.getInt((127&T)<<3):T,E}},asn1=forge.asn1=forge.asn1||{};asn1.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},asn1.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},asn1.create=function(o,B,T,E){if(E.constructor==Array){for(var I=[],C=0;C<E.length;++C)void 0!==E[C]&&I.push(E[C]);E=I}return{tagClass:o,type:B,constructed:T,composed:T||E.constructor==Array,value:E}},asn1.fromDer=function(o){if(o.constructor==String&&(o=forge.util.createBuffer(o)),2>o.length())throw{message:"Too few bytes to parse DER.",bytes:o.length()};var B=o.getByte(),T=192&B,E=31&B,I=_getValueLength(o);if(o.length()<I)throw{message:"Too few bytes to read ASN.1 value.",detail:o.length()+" < "+I};var C,S=32==(32&B),A=S;if(!A&&T===asn1.Class.UNIVERSAL&&E===asn1.Type.BITSTRING&&1<I){var D=o.read,N=o.getByte();if(0===N){B=o.getByte();var R=192&B;if(R===asn1.Class.UNIVERSAL||R===asn1.Class.CONTEXT_SPECIFIC)try{var L=_getValueLength(o);A=L===I-(o.read-D),A&&(++D,--I)}catch(V){}}o.read=D}if(!A){if(void 0===I)throw{message:"Non-constructed ASN.1 object of indefinite length."};if(E===asn1.Type.BMPSTRING){C="";for(var O=0;O<I;O+=2)C+=String.fromCharCode(o.getInt16())}else C=o.getBytes(I)}else if(C=[],void 0===I)for(;;){if(o.bytes(2)===String.fromCharCode(0,0)){o.getBytes(2);break}C.push(asn1.fromDer(o))}else for(var P=o.length();0<I;)C.push(asn1.fromDer(o)),I-=P-o.length(),P=o.length();return asn1.create(T,E,S,C)},asn1.toDer=function(o){var B=forge.util.createBuffer(),T=o.tagClass|o.type,E=forge.util.createBuffer();if(o.composed){o.constructed?T|=32:E.putByte(0);for(var I=0;I<o.value.length;++I)void 0!==o.value[I]&&E.putBuffer(asn1.toDer(o.value[I]))}else if(o.type===asn1.Type.BMPSTRING)for(var I=0;I<o.value.length;++I)E.putInt16(o.value.charCodeAt(I));else E.putBytes(o.value);if(B.putByte(T),127>=E.length())B.putByte(127&E.length());else{var C=E.length(),S="";do S+=String.fromCharCode(255&C),C>>>=8;while(0<C);B.putByte(128|S.length);for(var I=S.length-1;0<=I;--I)B.putByte(S.charCodeAt(I))}return B.putBuffer(E),B},pki.rsa.setPublicKey=function(o,B){var T={n:o,e:B};return T.encrypt=function(E){return pki.rsa.encrypt(E,T,2)},T.verify=function(E,I,C){var S,A=pki.rsa.decrypt(I,T,!0,S);if(void 0===C){var D=asn1.fromDer(A);return E===D.value[1].value}return C.verify(E,A,T.n.bitLength())},T};var GCD_30_DELTA=[6,4,2,4,2,4,6,2];pki.rsa.stepKeyPairGenerationState=function(o,B){var T=new BigInteger(null);T.fromInt(30);for(var S,E=0,I=function(P,O){return P|O},C=+new Date,A=0;null===o.keys&&(0>=B||A<B);){if(0===o.state){var D=null===o.p?o.pBits:o.qBits,N=D-1;0===o.pqState?(o.num=new BigInteger(D,o.rng),!o.num.testBit(N)&&o.num.bitwiseTo(BigInteger.ONE.shiftLeft(N),I,o.num),o.num.dAddOffset(31-o.num.mod(T).byteValue(),0),E=0,++o.pqState):1===o.pqState?o.num.bitLength()>D?o.pqState=0:o.num.isProbablePrime(1)?++o.pqState:o.num.dAddOffset(GCD_30_DELTA[E++%8],0):2===o.pqState?o.pqState=0===o.num.subtract(BigInteger.ONE).gcd(o.e).compareTo(BigInteger.ONE)?3:0:3===o.pqState&&(o.pqState=0,o.num.isProbablePrime(10)&&(null===o.p?o.p=o.num:o.q=o.num,null!==o.p&&null!==o.q&&++o.state),o.num=null)}else if(1===o.state)0>o.p.compareTo(o.q)&&(o.num=o.p,o.p=o.q,o.q=o.num),++o.state;else if(2===o.state)o.p1=o.p.subtract(BigInteger.ONE),o.q1=o.q.subtract(BigInteger.ONE),o.phi=o.p1.multiply(o.q1),++o.state;else if(3===o.state)0===o.phi.gcd(o.e).compareTo(BigInteger.ONE)?++o.state:(o.p=null,o.q=null,o.state=0);else if(4===o.state)o.n=o.p.multiply(o.q),o.n.bitLength()===o.bits?++o.state:(o.q=null,o.state=0);else if(5===o.state){var R=o.e.modInverse(o.phi);o.keys={privateKey:forge.pki.rsa.setPrivateKey(o.n,o.e,R,o.p,o.q,R.mod(o.p1),R.mod(o.q1),o.q.modInverse(o.p)),publicKey:forge.pki.rsa.setPublicKey(o.n,o.e)}}S=+new Date,A+=S-C,C=S}return null!==o.keys};function _generateKeyPair(o,B,T){function E(){I(o.pBits,function(O,V){return O?T(O):void(o.p=V,I(o.qBits,C))})}function I(O,V){function K(){var _=O-1,Y=new BigInteger(O,o.rng);return Y.testBit(_)||Y.bitwiseTo(BigInteger.ONE.shiftLeft(_),P,Y),Y.dAddOffset(31-Y.mod(L).byteValue(),0),Y}function U(_){if(!Q){--F;var Y=_.data;if(Y.found){for(var X=0;X<M.length;++X)M[X].terminate();return Q=!0,V(null,new BigInteger(Y.prime,16))}Z.bitLength()>O&&(Z=K());var H=Z.toString(16);_.target.postMessage({e:o.eInt,hex:H,workLoad:D}),Z.dAddOffset(30*D/8,0)}}for(var M=[],G=0;G<A;++G)M[G]=new Worker(R);for(var F=A,Z=K(),G=0;G<A;++G)M[G].addEventListener("message",U);var Q=!1}function C(O,V){if(o.q=V,0>o.p.compareTo(o.q)){var K=o.p;o.p=o.q,o.q=K}if(o.p1=o.p.subtract(BigInteger.ONE),o.q1=o.q.subtract(BigInteger.ONE),o.phi=o.p1.multiply(o.q1),0!==o.phi.gcd(o.e).compareTo(BigInteger.ONE))return o.p=o.q=null,void E();if(o.n=o.p.multiply(o.q),o.n.bitLength()!==o.bits)return o.q=null,void I(o.qBits,C);var U=o.e.modInverse(o.phi);o.keys={privateKey:forge.pki.rsa.setPrivateKey(o.n,o.e,U,o.p,o.q,U.mod(o.p1),U.mod(o.q1),o.q.modInverse(o.p)),publicKey:forge.pki.rsa.setPublicKey(o.n,o.e)},T(null,o.keys)}if("function"==typeof B&&(T=B,B={}),"undefined"==typeof Worker){var S=function(){return{v:function V(){return forge.pki.rsa.stepKeyPairGenerationState(o,10)?T(null,o.keys):void forge.util.setImmediate(V)}()}}();if("object"===("undefined"==typeof S?"undefined":_typeof(S)))return S.v}var A=B.workers||2,D=B.workLoad||100,R=B.workerScript||"forge/prime.worker.js",L=new BigInteger(null);L.fromInt(30);var P=function(V,K){return V|K};E()}pki.rsa.generateKeyPair=function(o,B,T,E){1===arguments.length?"object"===("undefined"==typeof o?"undefined":_typeof(o))?(T=o,o=void 0):"function"==typeof o&&(E=o,o=void 0):2===arguments.length?("number"==typeof o?"function"==typeof B?E=B:T=B:(T=o,E=B,o=void 0),B=void 0):3===arguments.length&&("number"==typeof B?"function"==typeof T&&(E=T,T=void 0):(E=T,T=B,B=void 0)),T=T||{},o===void 0&&(o=T.bits||1024),B===void 0&&(B=T.e||65537);var I=pki.rsa.createKeyPairGenerationState(o,B);return E?void _generateKeyPair(I,T,E):(pki.rsa.stepKeyPairGenerationState(I,0),I.keys)};var _bnToBytes=function(B){var T=B.toString(16);return"8"<=T[0]&&(T="00"+T),forge.util.hexToBytes(T)};pki.publicKeyToRSAPublicKey=function(o){return asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(o.n)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(o.e))])};var _base64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";util.encode64=function(o,B){for(var I,C,S,T="",E="",A=0;A<o.length;)I=o.charCodeAt(A++),C=o.charCodeAt(A++),S=o.charCodeAt(A++),T+=_base64.charAt(I>>2),T+=_base64.charAt((3&I)<<4|C>>4),isNaN(C)?T+="==":(T+=_base64.charAt((15&C)<<2|S>>6),T+=isNaN(S)?"=":_base64.charAt(63&S)),B&&T.length>B&&(E+=T.substr(0,B)+"\r\n",T=T.substr(B));return E+=T,E},pki.publicKeyToRSAPublicKeyPem=function(o,B){var T=asn1.toDer(pki.publicKeyToRSAPublicKey(o));return T=forge.util.encode64(T.getBytes(),B||64),"-----BEGIN RSA PUBLIC KEY-----\r\n"+T+"\r\n-----END RSA PUBLIC KEY-----"},pki.privateKeyToAsn1=pki.privateKeyToRSAPrivateKey=function(o){return asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,String.fromCharCode(0)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(o.n)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(o.e)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(o.d)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(o.p)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(o.q)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(o.dP)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(o.dQ)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(o.qInv))])},pki.privateKeyToPem=function(o,B){var T=asn1.toDer(pki.privateKeyToAsn1(o));return T=forge.util.encode64(T.getBytes(),B||64),"-----BEGIN RSA PRIVATE KEY-----\r\n"+T+"\r\n-----END RSA PRIVATE KEY-----"};