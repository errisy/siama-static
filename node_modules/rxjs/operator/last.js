"use strict";var __extends=function(a,c){function e(){this.constructor=a}for(var f in c)c.hasOwnProperty(f)&&(a[f]=c[f]);a.prototype=null===c?Object.create(c):(e.prototype=c.prototype,new e)},Subscriber_1=require("rxjs/Subscriber"),EmptyError_1=require("rxjs/util/EmptyError");function last(a,c,e){return this.lift(new LastOperator(a,c,e,this))}exports.last=last;var LastOperator=function(){function a(c,e,f,g){this.predicate=c,this.resultSelector=e,this.defaultValue=f,this.source=g}return a.prototype.call=function(c,e){return e._subscribe(new LastSubscriber(c,this.predicate,this.resultSelector,this.defaultValue,this.source))},a}(),LastSubscriber=function(a){function c(e,f,g,h,i){a.call(this,e),this.predicate=f,this.resultSelector=g,this.defaultValue=h,this.source=i,this.hasValue=!1,this.index=0,"undefined"!=typeof h&&(this.lastValue=h,this.hasValue=!0)}return __extends(c,a),c.prototype._next=function(e){var f=this.index++;if(this.predicate)this._tryPredicate(e,f);else{if(this.resultSelector)return void this._tryResultSelector(e,f);this.lastValue=e,this.hasValue=!0}},c.prototype._tryPredicate=function(e,f){var g;try{g=this.predicate(e,f,this.source)}catch(h){return void this.destination.error(h)}if(g){if(this.resultSelector)return void this._tryResultSelector(e,f);this.lastValue=e,this.hasValue=!0}},c.prototype._tryResultSelector=function(e,f){var g;try{g=this.resultSelector(e,f)}catch(h){return void this.destination.error(h)}this.lastValue=g,this.hasValue=!0},c.prototype._complete=function(){var e=this.destination;this.hasValue?(e.next(this.lastValue),e.complete()):e.error(new EmptyError_1.EmptyError)},c}(Subscriber_1.Subscriber);